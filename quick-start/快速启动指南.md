# NL2SQL å¯¹è¯é¡µé¢ - å¿«é€Ÿå¯åŠ¨æŒ‡å—

## âš ï¸ é‡è¦æç¤º

æ‚¨é‡åˆ°çš„ **404 é”™è¯¯** æ˜¯å› ä¸ºé€šè¿‡ IntelliJ IDEA çš„å†…ç½®æœåŠ¡å™¨ï¼ˆç«¯å£ 63342ï¼‰æ‰“å¼€äº† HTML æ–‡ä»¶ï¼Œè€Œä¸æ˜¯é€šè¿‡ Spring Boot åº”ç”¨è®¿é—®ã€‚

## âœ… æ­£ç¡®çš„ä½¿ç”¨æ­¥éª¤

### æ­¥éª¤ 1ï¼šå¯åŠ¨ Spring Boot åº”ç”¨

åœ¨ IntelliJ IDEA ä¸­ï¼š

**æ–¹æ³• Aï¼šä½¿ç”¨ Maven**
```bash
cd quick-start
mvn spring-boot:run
```

**æ–¹æ³• Bï¼šè¿è¡Œä¸»ç±»**
1. æ‰¾åˆ° `Application.java` æ–‡ä»¶
2. å³é”®ç‚¹å‡» â†’ Run 'Application'

**æ–¹æ³• Cï¼šä½¿ç”¨å‘½ä»¤è¡Œ**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
cd quick-start
mvn clean package
java -jar target/quick-start-*.jar
```

### æ­¥éª¤ 2ï¼šç¡®è®¤åº”ç”¨å¯åŠ¨æˆåŠŸ

åœ¨æ§åˆ¶å°çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
Tomcat started on port(s): 8082 (http)
Started Application in X.XXX seconds
```

### æ­¥éª¤ 3ï¼šè®¿é—®é¡µé¢

**æ­£ç¡®çš„è®¿é—®æ–¹å¼ï¼š**
```
http://localhost:8082/nl2sql-chat.html
```

**âŒ é”™è¯¯çš„è®¿é—®æ–¹å¼ï¼š**
- ~~ç›´æ¥åœ¨ IntelliJ IDEA ä¸­å³é”® HTML æ–‡ä»¶ â†’ Open in Browser~~
- ~~é€šè¿‡ file:// åè®®æ‰“å¼€~~
- ~~é€šè¿‡ç«¯å£ 63342 è®¿é—®~~

## ğŸ” é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼š302 é‡å®šå‘é”™è¯¯

**ç—‡çŠ¶ï¼š**
```
Status Code: 302 Found
è¯·æ±‚è¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢
```

**åŸå› ï¼š**
Spring Security æ‹¦æˆªäº†è¯·æ±‚ï¼Œè¦æ±‚è®¤è¯ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
å·²åœ¨ `SecurityConfig.java` ä¸­æ·»åŠ äº†ç™½åå•é…ç½®ï¼š
```java
.requestMatchers("/send").permitAll()
.requestMatchers("/nl2sql-chat.html").permitAll()
.requestMatchers("/*.html").permitAll()
```

**é‡å¯åº”ç”¨åç”Ÿæ•ˆï¼**

### é—®é¢˜ 2ï¼šç«¯å£ 8082 è¢«å ç”¨

**ç—‡çŠ¶ï¼š**
```
Port 8082 was already in use
```

**è§£å†³æ–¹æ¡ˆï¼š**

**æ–¹æ¡ˆ Aï¼šä¿®æ”¹ç«¯å£**
ç¼–è¾‘ `application.yml`ï¼š
```yaml
server:
  port: 8083  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

ç„¶åè®¿é—®ï¼š`http://localhost:8083/nl2sql-chat.html`

**æ–¹æ¡ˆ Bï¼šå…³é—­å ç”¨ç«¯å£çš„è¿›ç¨‹**
```bash
# Windows
netstat -ano | findstr :8082
taskkill /PID <è¿›ç¨‹ID> /F

# Linux/Mac
lsof -i :8082
kill -9 <è¿›ç¨‹ID>
```

### é—®é¢˜ 2ï¼š404 Not Found

**å¯èƒ½åŸå› ï¼š**
1. Spring Boot åº”ç”¨æœªå¯åŠ¨
2. è®¿é—®äº†é”™è¯¯çš„ URL
3. HTML æ–‡ä»¶ä¸åœ¨ `src/main/resources/static/` ç›®å½•

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤åº”ç”¨æ­£åœ¨è¿è¡Œ
2. ä½¿ç”¨æ­£ç¡®çš„ URLï¼š`http://localhost:8082/nl2sql-chat.html`
3. æ£€æŸ¥æ–‡ä»¶ä½ç½®ï¼š`quick-start/src/main/resources/static/nl2sql-chat.html`

### é—®é¢˜ 3ï¼šCORS é”™è¯¯

**ç—‡çŠ¶ï¼š**
```
Access to XMLHttpRequest has been blocked by CORS policy
```

**è§£å†³æ–¹æ¡ˆï¼š**
è¿™é€šå¸¸å‘ç”Ÿåœ¨ç›´æ¥æ‰“å¼€ HTML æ–‡ä»¶æ—¶ã€‚è¯·é€šè¿‡ Spring Boot è®¿é—®ã€‚

å¦‚æœéœ€è¦è·¨åŸŸæ”¯æŒï¼Œæ·»åŠ é…ç½®ï¼š

```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedOrigins("*")
                .allowedMethods("GET", "POST");
    }
}
```

### é—®é¢˜ 4ï¼šSSE è¿æ¥å¤±è´¥

**ç—‡çŠ¶ï¼š**
- æ¶ˆæ¯å‘é€åä¸€ç›´æ˜¾ç¤º"å¤„ç†ä¸­..."
- æ§åˆ¶å°æ˜¾ç¤º EventSource é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥åç«¯æ¥å£æ˜¯å¦æ­£å¸¸ï¼š
   ```bash
   curl "http://localhost:8082/send?message=ä½ å¥½"
   ```

2. æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒ SSEï¼ˆEventSource APIï¼‰

3. æŸ¥çœ‹åç«¯æ—¥å¿—æ˜¯å¦æœ‰å¼‚å¸¸

## ğŸ“ æµ‹è¯•æ­¥éª¤

### 1. æµ‹è¯•åç«¯æ¥å£

åœ¨æµè§ˆå™¨æˆ–ä½¿ç”¨ curl æµ‹è¯•ï¼š
```bash
curl "http://localhost:8082/send?message=ä½ å¥½"
```

åº”è¯¥çœ‹åˆ°æµå¼å“åº”ã€‚

### 2. æµ‹è¯•å‰ç«¯é¡µé¢

1. è®¿é—®ï¼š`http://localhost:8082/nl2sql-chat.html`
2. ç‚¹å‡»ç¤ºä¾‹æŸ¥è¯¢æˆ–è¾“å…¥æ¶ˆæ¯
3. è§‚å¯Ÿæ˜¯å¦æœ‰å®æ—¶å“åº”

### 3. æµ‹è¯• SQL æŸ¥è¯¢

è¾“å…¥ç±»ä¼¼çš„æŸ¥è¯¢ï¼š
- "ç»Ÿè®¡æ‰€æœ‰ç”¨æˆ·çš„æ•°é‡"
- "æŸ¥è¯¢é”€å”®é¢æœ€é«˜çš„å‰10ä¸ªäº§å“"
- "è®¡ç®—æœ¬æœˆçš„å¹³å‡è®¢å•é‡‘é¢"

## ğŸ¯ å®Œæ•´çš„å·¥ä½œæµç¨‹

```
1. å¯åŠ¨ Spring Boot åº”ç”¨
   â†“
2. åº”ç”¨ç›‘å¬ç«¯å£ 8082
   â†“
3. æµè§ˆå™¨è®¿é—® http://localhost:8082/nl2sql-chat.html
   â†“
4. Spring Boot è¿”å› HTML æ–‡ä»¶
   â†“
5. ç”¨æˆ·è¾“å…¥æ¶ˆæ¯
   â†“
6. JavaScript å‘é€ SSE è¯·æ±‚åˆ° /send
   â†“
7. åç«¯å¤„ç†å¹¶æµå¼è¿”å›å“åº”
   â†“
8. å‰ç«¯å®æ—¶æ˜¾ç¤ºå“åº”å†…å®¹
```

## ğŸ”§ å¼€å‘ç¯å¢ƒé…ç½®

### å¿…éœ€çš„ä¾èµ–

ç¡®ä¿ `pom.xml` åŒ…å«ï¼š
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
```

### é™æ€èµ„æºé…ç½®

Spring Boot é»˜è®¤ä¼šè‡ªåŠ¨æœåŠ¡ `src/main/resources/static/` ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚

å¦‚éœ€è‡ªå®šä¹‰é…ç½®ï¼š
```yaml
spring:
  web:
    resources:
      static-locations: classpath:/static/
```

## ğŸ“± ç§»åŠ¨ç«¯è®¿é—®

å¦‚æœéœ€è¦åœ¨æ‰‹æœºä¸Šæµ‹è¯•ï¼š

1. ç¡®ä¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€ç½‘ç»œ
2. è·å–ç”µè„‘çš„ IP åœ°å€ï¼š
   ```bash
   # Windows
   ipconfig
   
   # Linux/Mac
   ifconfig
   ```
3. åœ¨æ‰‹æœºæµè§ˆå™¨è®¿é—®ï¼š
   ```
   http://<ç”µè„‘IP>:8082/nl2sql-chat.html
   ```

## ğŸš€ ç”Ÿäº§éƒ¨ç½²å»ºè®®

1. **æ‰“åŒ…åº”ç”¨**
   ```bash
   mvn clean package
   ```

2. **è¿è¡Œ JAR**
   ```bash
   java -jar target/quick-start-*.jar
   ```

3. **ä½¿ç”¨ Nginx åå‘ä»£ç†**ï¼ˆå¯é€‰ï¼‰
   ```nginx
   server {
       listen 80;
       server_name your-domain.com;
       
       location / {
           proxy_pass http://localhost:8082;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
       }
   }
   ```

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä»ç„¶é‡åˆ°é—®é¢˜ï¼š

1. æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—
2. æŸ¥çœ‹æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Network å’Œ Console æ ‡ç­¾
3. ç¡®è®¤æ‰€æœ‰ä¾èµ–éƒ½å·²æ­£ç¡®å®‰è£…
4. å°è¯•é‡å¯ IDE å’Œåº”ç”¨

---

**è®°ä½ï¼šå§‹ç»ˆé€šè¿‡ Spring Boot åº”ç”¨è®¿é—®é¡µé¢ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰“å¼€ HTML æ–‡ä»¶ï¼**
